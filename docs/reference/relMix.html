<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates likelihoods for relationship inference involving mixtures and missing reference profiles,
including drop-in and dropout, mutations, silent alleles and theta correction."><title>Relationship inference based on mixtures — relMix • relMix</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Relationship inference based on mixtures — relMix"><meta property="og:description" content="Calculates likelihoods for relationship inference involving mixtures and missing reference profiles,
including drop-in and dropout, mutations, silent alleles and theta correction."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">relMix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/relMix.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Relationship inference based on mixtures</h1>
      
      <div class="d-none name"><code>relMix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates likelihoods for relationship inference involving mixtures and missing reference profiles,
including drop-in and dropout, mutations, silent alleles and theta correction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">relMix</span><span class="op">(</span></span>
<span>  <span class="va">pedigrees</span>,</span>
<span>  <span class="va">locus</span>,</span>
<span>  <span class="va">R</span>,</span>
<span>  <span class="va">datamatrix</span>,</span>
<span>  <span class="va">ids</span>,</span>
<span>  D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  di <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  kinship <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>pedigrees</dt>
<dd><p>A list of pedigrees defined using <code>FamiliasPedigree</code></p></dd>


<dt>locus</dt>
<dd><p>A list of class <code>FamiliasLocus</code> containing information about the locus. Note that a silent allele must be indicated by 's' (and not 'silent' as in Familias)</p></dd>


<dt>R</dt>
<dd><p>A vector of mixture alleles, or a list of such if there are multiple replicates</p></dd>


<dt>datamatrix</dt>
<dd><p>A data frame where each line corresponds to one constellation of genotypes for the involved individuals.
Indices of individuals must be given as rownames and must correspond to indices in the pedigree</p></dd>


<dt>ids</dt>
<dd><p>Index vector indicating which individuals are contributors to the mixture. The indices must correspond to
indices in the pedigree</p></dd>


<dt>D</dt>
<dd><p>List of numeric dropout values (between 0 and 1) per contributor.
Each element is a vector containing heterozygous and homozygous dropout probability for the given contributor</p></dd>


<dt>di</dt>
<dd><p>A numeric drop-in value (between 0 and 1)</p></dd>


<dt>kinship</dt>
<dd><p>A numeric value between 0 and 1 that defines the theta-parameter</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A numeric likelihood for each pedigree named according to the pedigrees, and a matrix of likelihoods for each pedigree and each term (genotype constellation) considered in the calculation
(one row per term).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function requires the package <code>Familias</code> and calls on the function <code>FamiliasPosterior</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dorum et al. (2017) &lt;doi:10.1007/s00414-016-1526-x&gt; <br>
Kaur et al. (2016) &lt;doi:10.1007/s00414-015-1276-1&gt; <br></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="relMixGUI.html">relMixGUI</a></code> for the GUI version of relMix, <code>FamiliasLocus</code> on how to create a FamiliasLocus and <code>FamiliasPedigree</code> on how to create a FamiliasPedigree.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Navreet Kaur, Thore Egeland, Guro Dorum</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Example 1: paternity trio with mixture of mother and child</span></span></span>
<span class="r-in"><span><span class="co">#Define alleles and frequencies</span></span></span>
<span class="r-in"><span><span class="va">alleles</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">afreq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Define pedigrees</span></span></span>
<span class="r-in"><span><span class="va">persons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CH"</span>,<span class="st">"MO"</span>,<span class="st">"AF"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped1</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasPedigree.html" class="external-link">FamiliasPedigree</a></span><span class="op">(</span>id<span class="op">=</span><span class="va">persons</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AF"</span>,<span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span>, <span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped2</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasPedigree.html" class="external-link">FamiliasPedigree</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">persons</span>, <span class="st">"TF"</span><span class="op">)</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedigrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>isFather <span class="op">=</span> <span class="va">ped1</span>, unrelated<span class="op">=</span><span class="va">ped2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Create locus object</span></span></span>
<span class="r-in"><span><span class="va">locus</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasLocus.html" class="external-link">FamiliasLocus</a></span><span class="op">(</span>frequencies<span class="op">=</span><span class="va">afreq</span>,name<span class="op">=</span><span class="st">"M1"</span>,</span></span>
<span class="r-in"><span>                      allelenames<span class="op">=</span> <span class="va">alleles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Known genotypes of alleged father and mother</span></span></span>
<span class="r-in"><span><span class="va">gAF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gMO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Mixture alleles</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">datamatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDatamatrix.html">createDatamatrix</a></span><span class="op">(</span><span class="va">locus</span>,knownGenos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AF<span class="op">=</span><span class="va">gAF</span>,MO<span class="op">=</span><span class="va">gMO</span><span class="op">)</span>,idsU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Define dropout and drop-in values</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="va">di</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">relMix</span><span class="op">(</span><span class="va">pedigrees</span>, <span class="va">locus</span>, <span class="va">R</span>, <span class="va">datamatrix</span>, ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span>,<span class="st">"CH"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             D<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d</span>,<span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,di<span class="op">=</span><span class="va">di</span>, kinship<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#LR=0.054</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">isFather</span><span class="op">/</span><span class="va">res</span><span class="op">$</span><span class="va">unrelated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05417118</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 2: Exhaustive example with silent allele, mutations, dropout and drop-in</span></span></span>
<span class="r-in"><span><span class="co">#H1: Contributors are mother and child</span></span></span>
<span class="r-in"><span><span class="co">#H2: Contributors are mother and unrelated</span></span></span>
<span class="r-in"><span><span class="co">#Possible dropout in both contributors</span></span></span>
<span class="r-in"><span><span class="va">gMO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#Mother's genotype</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#Mixture alleles</span></span></span>
<span class="r-in"><span><span class="co">#Mother/child pedigree</span></span></span>
<span class="r-in"><span><span class="va">persons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CH"</span>,<span class="st">"MO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped1</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasPedigree.html" class="external-link">FamiliasPedigree</a></span><span class="op">(</span>id<span class="op">=</span><span class="va">persons</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped2</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasPedigree.html" class="external-link">FamiliasPedigree</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">persons</span><span class="op">)</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedigrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>H1 <span class="op">=</span> <span class="va">ped1</span>, H2<span class="op">=</span><span class="va">ped2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Alleles and frequencies:</span></span></span>
<span class="r-in"><span><span class="co">#When silent alleles are involved, a custom mutation matrix is required.</span></span></span>
<span class="r-in"><span><span class="co">#No mutations are possible to or from silent alleles.</span></span></span>
<span class="r-in"><span><span class="co">#We create the mutation model with FamiliasLocus and modify it before it is</span></span></span>
<span class="r-in"><span><span class="co">#passed on to relMix</span></span></span>
<span class="r-in"><span><span class="va">alleles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="st">'silent'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">afreq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Create initial locus object with mutation matrix</span></span></span>
<span class="r-in"><span><span class="va">locus</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasLocus.html" class="external-link">FamiliasLocus</a></span><span class="op">(</span>frequencies<span class="op">=</span><span class="va">afreq</span>,name<span class="op">=</span><span class="st">'M1'</span>,</span></span>
<span class="r-in"><span>                      allelenames<span class="op">=</span> <span class="va">alleles</span>, MutationModel<span class="op">=</span><span class="st">'Equal'</span>,</span></span>
<span class="r-in"><span>                      femaleMutationRate<span class="op">=</span><span class="fl">0.1</span>,maleMutationRate<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Modify mutation matrix from Familias:</span></span></span>
<span class="r-in"><span><span class="co">#Silent allele must be given as 's' (not 'silent' as in Familias)</span></span></span>
<span class="r-in"><span><span class="va">newAlleles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alleles</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">alleles</span><span class="op">)</span><span class="op">]</span>,<span class="st">'s'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="va">locus</span><span class="op">$</span><span class="va">femaleMutationMatrix</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">newAlleles</span></span></span>
<span class="r-in"><span><span class="co">#Create new locus object with modified mutation matrix</span></span></span>
<span class="r-in"><span><span class="va">locus</span> <span class="op">&lt;-</span> <span class="fu">Familias</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Familias/man/FamiliasLocus.html" class="external-link">FamiliasLocus</a></span><span class="op">(</span>frequencies<span class="op">=</span><span class="va">afreq</span>,name<span class="op">=</span><span class="st">'M1'</span>,</span></span>
<span class="r-in"><span>                      allelenames<span class="op">=</span> <span class="va">newAlleles</span>, MutationModel<span class="op">=</span><span class="st">'Custom'</span>, MutationMatrix<span class="op">=</span><span class="va">mm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">knownGenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gMO</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">knownGenos</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">datamatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDatamatrix.html">createDatamatrix</a></span><span class="op">(</span><span class="va">locus</span>,<span class="va">knownGenos</span>,ids<span class="op">=</span><span class="st">"CH"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co">#Dropout probability for both contributors</span></span></span>
<span class="r-in"><span><span class="va">di</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">relMix</span><span class="op">(</span><span class="va">pedigrees</span>, <span class="va">locus</span>, <span class="va">R</span>, <span class="va">datamatrix</span>, ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MO"</span>,<span class="st">"CH"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              D<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d</span>,<span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d</span>,<span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,di<span class="op">=</span><span class="va">di</span>, kinship<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#LR=1.68</span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">$</span><span class="va">H1</span><span class="op">/</span><span class="va">res2</span><span class="op">$</span><span class="va">H2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.677973</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Guro Dorum, Elias Hernandis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer></div>

  

  

  </body></html>

