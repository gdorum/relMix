<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="relMix">
<title>RelMix 1.3 • relMix</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RelMix 1.3">
<meta property="og:description" content="relMix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">relMix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/relMix.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>RelMix 1.3</h1>
                        <h4 data-toc-skip class="author">Guro Dorum</h4>
            
            <h4 data-toc-skip class="date">2023-08-08</h4>
      
      
      <div class="d-none name"><code>relMix.Rmd</code></div>
    </div>

    
    
<p>This vignette gives an introduction to RelMix 1.3, the graphical user
interface of the relMix package described in Dørum et al. (2017). We
will present the main features of the GUI with two examples.</p>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Start RelMix by typing the following command in the R console</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/relMixGUI.html">relMixGUI</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p>which will open the user interface seen in Figure 1.</p>
<div class="figure">
<img src="relMix_screenshot.png" alt="Figure 1: The RelMix main window." width="400"><p class="caption">
Figure 1: The RelMix main window.
</p>
</div>
</div>
<div class="section level2">
<h2 id="example-1-a-paternity-case">Example 1: A paternity case<a class="anchor" aria-label="anchor" href="#example-1-a-paternity-case"></a>
</h2>
<p>In this example we consider a paternity case where we have a mixed
DNA profile of a mother and child, in addition to reference profiles
from the mother and the alleged father.</p>
<div class="section level3">
<h3 id="import-data">1. Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h3>
<p>The first step in RelMix is to import data. The import files must be
either comma, semicolon or tab-separated and must have dots as decimal
separators. Examples will be given for the three types of files that are
needed: mixture profile, reference profiles and allele frequencies. The
mixture profile and reference profiles should contain the same loci in
the same order, while the allele frequency file can contain additional
loci not in the profiles. RelMix will give an error message if the data
file has an error that is fatal for the program. RelMix will return a
warning if there is a minor error in the data file that is not fatal for
the program.</p>
<div class="section level4">
<h4 id="a--mixture-profile">1a. Mixture profile<a class="anchor" aria-label="anchor" href="#a--mixture-profile"></a>
</h4>
<p>Table 1 shows the structure of the mixture file. The first line
should contain column names as shown here: ‘SampleName’, ‘Marker’,
‘Allele1’ etc. The mixture profile in this example has a maximum of
three unique alleles per markers, but the file may be expanded with
columns ‘Allele4’, ‘Allele5’ and so on if there are additional observed
alleles. In this example there are 22 markers, but only the first five
are shown here. Only autosomal markers can be included. Marker names are
case sensitive, and an error message will be given if markers are not
found in the database.</p>
<table style="width:75%;" class="table">
<caption>Table 1: The mixture profile in example 1.</caption>
<colgroup>
<col width="18%">
<col width="15%">
<col width="13%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">SampleName</th>
<th align="center">Marker</th>
<th align="center">Allele1</th>
<th align="center">Allele2</th>
<th align="center">Allele3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">relMix</td>
<td align="center">CSF1PO</td>
<td align="center">10</td>
<td align="center">11</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="center">relMix</td>
<td align="center">D10S1248</td>
<td align="center">16</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">relMix</td>
<td align="center">D13S317</td>
<td align="center">9</td>
<td align="center">12</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="center">relMix</td>
<td align="center">D14S1434</td>
<td align="center">10</td>
<td align="center">13</td>
<td align="center">14</td>
</tr>
<tr class="odd">
<td align="center">relMix</td>
<td align="center">D16S539</td>
<td align="center">12</td>
<td align="center">14</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
</tbody>
</table>
<p>If there are multiple replicates, the next replicate profile must
have a different sample name (e.g. “relMix2”) and follow directly after
the first replicate (i.e. no blank lines between).</p>
</div>
<div class="section level4">
<h4 id="b--reference-profiles">1b. Reference profiles<a class="anchor" aria-label="anchor" href="#b--reference-profiles"></a>
</h4>
<p>Table 2 shows the format of the file containing the reference
profiles (all reference profiles have to be in the same file). The first
line should correspond to the column names seen here. The different
reference profiles follow directly after each other, and each profile
should have a specific sample name. In our example there are two
reference profiles, “Mother” and “Father”. The file shoud only contain
profiles of individuals defined in the pedigree. <strong>Note:</strong>
as long as the built-in pedigrees are used, the reference profiles
should be named either “Father”, “Mother” or “Child” because these are
the only individual IDs that are defined in these pedigrees. If custom
pedigrees are provided, any sample name can be used (see example 2
below). Only the first two markers and the last one are shown for each
profile.</p>
<table class="table">
<caption>Table 2: Reference profiles for mother and alleged father in
example 1.</caption>
<thead><tr class="header">
<th align="left">SampleName</th>
<th align="left">Marker</th>
<th align="left">Allele1</th>
<th align="left">Allele2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mother</td>
<td align="left">CSF1PO</td>
<td align="left">10</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">Mother</td>
<td align="left">D10S1248</td>
<td align="left">16</td>
<td align="left">16</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left">Mother</td>
<td align="left">TPOX</td>
<td align="left">8</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">Father</td>
<td align="left">CSF1PO</td>
<td align="left">12</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">Father</td>
<td align="left">D10S1248</td>
<td align="left">14</td>
<td align="left">15</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left">Father</td>
<td align="left">TPOX</td>
<td align="left">8</td>
<td align="left">11</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="c--database">1c. Database<a class="anchor" aria-label="anchor" href="#c--database"></a>
</h4>
<div class="figure" style="text-align: center">
<img src="database_crop.png" alt="Figure 2: Database window." width="30%"><p class="caption">
Figure 2: Database window.
</p>
</div>
<p>When clicking the database button in the main interface, the window
in Figure 2 appears. Table 3 shows the format of the allele frequencies
to be imported here. There is one row per allele and one column per
marker. A blank space indicates that the allele is not observed for that
marker. Only an excerpt of the database is shown here.</p>
<table style="width:99%;" class="table">
<caption>Table 3: Excerpt of the allele frequency database in example 1.
Dots are used as decimal separator.</caption>
<colgroup>
<col width="12%">
<col width="19%">
<col width="19%">
<col width="19%">
<col width="19%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="center">Allele</th>
<th align="center">CSF1PO</th>
<th align="center">D10S1248</th>
<th align="center">D13S317</th>
<th align="center">D16S539</th>
<th align="center">…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">9</td>
<td align="center">0.013850416</td>
<td align="center"></td>
<td align="center">0.077562327</td>
<td align="center">0.106648199</td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center">9.1</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">9.3</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">0.220221607</td>
<td align="center"></td>
<td align="center">0.047091413</td>
<td align="center">0.056786704</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">10.1</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center">10.2</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">10.3</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">…</td>
</tr>
<tr class="even">
<td align="center">11</td>
<td align="center">0.308864266</td>
<td align="center">0.001385042</td>
<td align="center">0.325484765</td>
<td align="center">0.314404432</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
</tbody>
</table>
Clicking the ‘Option’ button opens up the window in Figure 3 with three
additional settings: a theta value to correct for population
substructure, a silent allele frequency and a minimum allele frequency.
Any alleles with frequencies below the minimum allele frequency will by
default be set to 0.001, this also applies to previously unobserved
alleles. For this example we will keep the default values.
<div class="figure">
<img src="database_options.png" alt="Figure 3: Database options. Theta value, silent allele frequency and minimum allele frequency." width="350"><p class="caption">
Figure 3: Database options. Theta value, silent allele frequency and
minimum allele frequency.
</p>
</div>
<p>When clicking ‘Save’ here we return to the window in Figure 2, where
we need to click ‘ok’ to exit the database settings. If a previously
unobserved allele (i.e. not in the database) is found in the imported
profiles, a notification will be given that the alllele has been added
to the database with the minimum allele frequency. If the allele
frequencies do not sum to 1, a question will appear of whether you would
like to scale the frequencies. If not, a rest allele will be added.</p>
</div>
</div>
<div class="section level3">
<h3 id="mutations">2. Mutations<a class="anchor" aria-label="anchor" href="#mutations"></a>
</h3>
<p>In this example we will not consider mutations, so we can ignore the
‘Mutations’ button.</p>
</div>
<div class="section level3">
<h3 id="pedigree">3. Pedigree<a class="anchor" aria-label="anchor" href="#pedigree"></a>
</h3>
The pedigrees define the hypotheses. There are three choices of
pedigrees: ‘Paternity’, ‘Unrelated’ and ‘Custom’. We choose ‘Paternity’
as the first pedigree and ‘Unrelated’ (alleged father and child are
unrelated) as the second pedigree (Figure 4). In example 2 we show how
to define a custom pedigree.
<div class="figure">
<img src="pedigrees_ex1.png" alt="Figure 4: Define the pedigrees in example 1." width="300"><p class="caption">
Figure 4: Define the pedigrees in example 1.
</p>
</div>
</div>
<div class="section level3">
<h3 id="contributors">4. Contributors<a class="anchor" aria-label="anchor" href="#contributors"></a>
</h3>
Clicking the ‘Specify contributors’ button opens the window in Figure 5.
We tick the individuals in the pedigree that are in the mixture, in this
case the mother and child. It is possible to have different contributors
for each pedigree, but here the contributors are the same under both
hypotheses.
<div class="figure">
<img src="contributors_ex1.png" alt="Figure 5: Specify mother and child as the contributors in both pedigrees in example 1." width="150"><p class="caption">
Figure 5: Specify mother and child as the contributors in both pedigrees
in example 1.
</p>
</div>
</div>
<div class="section level3">
<h3 id="dropout-and-drop-in">5. Dropout and drop-in<a class="anchor" aria-label="anchor" href="#dropout-and-drop-in"></a>
</h3>
The last step is to specify dropout and drop-in values. See Dørum et
al. (2017) for a detailed description about the drop-in/dropout model.
By default all values are set to 0. In this case we expect no dropout
from the mother so we set her dropout probability to 0, while the child
is given a dropout probability of 0.1. The drop-in value is set to 0.05
(Figure 6).
<div class="figure">
<img src="dropout_ex1.png" alt="Figure 6: In example 1 we assume dropout probabilities 0 for the mother and 0.1 for the child and drop-in 0.05." width="150"><p class="caption">
Figure 6: In example 1 we assume dropout probabilities 0 for the mother
and 0.1 for the child and drop-in 0.05.
</p>
</div>
<p>Note that if the dropout values are not set, an error window will
occur. Even if you do not include dropout and drop-in, you must open the
dropout window and click on the save button.</p>
</div>
<div class="section level3">
<h3 id="compute-lr">6. Compute LR<a class="anchor" aria-label="anchor" href="#compute-lr"></a>
</h3>
Finally, we are ready to click the ‘Compute LR’ button. The result
appears in a new pop-up window (Figure 7). The chosen parameters are
displayed on the left, top right shows the pedigrees, followed by the
total LR and a table displaying the LRs per marker. By clicking “Save
results to file”, the LRs together with the mixture profiles, reference
profiles and the parameters will be saved to file.
<div class="figure">
<img src="results_ex1.png" alt="Figure 7: Results for example 1." width="500"><p class="caption">
Figure 7: Results for example 1.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-2-mutations-silent-alleles-and-custom-pedigree">Example 2: Mutations, silent alleles and custom pedigree<a class="anchor" aria-label="anchor" href="#example-2-mutations-silent-alleles-and-custom-pedigree"></a>
</h2>
<p>Click the RESTART button before starting on a new case.</p>
<p>In this example we have a two-person mixture with one known
contributor, and it is hypothesised whether the second contributor is
the child of the first contributor, or someone unrelated. We take silent
alleles and mutations into account. Only one locus is considered.</p>
<div class="section level3">
<h3 id="import-data-1">1. Import data<a class="anchor" aria-label="anchor" href="#import-data-1"></a>
</h3>
<div class="section level4">
<h4 id="a--mixture-profile-1">1a. Mixture profile<a class="anchor" aria-label="anchor" href="#a--mixture-profile-1"></a>
</h4>
<p>Table 4 shows the mixture file. There is only one observed allele for
this locus.</p>
<table style="width:44%;" class="table">
<caption>Table 4: Mixture file for example 2.</caption>
<colgroup>
<col width="18%">
<col width="12%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">SampleName</th>
<th align="center">Marker</th>
<th align="center">Allele1</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">relMix1</td>
<td align="center">M1</td>
<td align="center">1</td>
</tr></tbody>
</table>
</div>
<div class="section level4">
<h4 id="b--reference-profiles-1">1b. Reference profiles<a class="anchor" aria-label="anchor" href="#b--reference-profiles-1"></a>
</h4>
<p>In this example there is only one known profile. Since we will
provide a custom pedigree, the sample name of the profile can be
anything as long as it corresponds to the ID in the pedigree.</p>
<table class="table">
<caption>Table 5: Reference profile for the known contributor (C1) in
example 2.</caption>
<thead><tr class="header">
<th align="left">SampleName</th>
<th align="left">Marker</th>
<th align="right">Allele1</th>
<th align="right">Allele2</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">C1</td>
<td align="left">M1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr></tbody>
</table>
</div>
<div class="section level4">
<h4 id="c--database-1">1c. Database<a class="anchor" aria-label="anchor" href="#c--database-1"></a>
</h4>
<p>The allele frequencies of the one diallelic marker are given in Table
6.</p>
<table style="width:21%;" class="table">
<caption>Table 6: Allele frequencies.</caption>
<colgroup>
<col width="12%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="center">Allele</th>
<th align="center">M1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.4</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">0.6</td>
</tr>
</tbody>
</table>
In the database options we set the silent allele frequency equal to 0.1
(Figure 8).
<div class="figure">
<img src="database_options_ex2.png" alt="Figure 8: Database options for example 2." width="350"><p class="caption">
Figure 8: Database options for example 2.
</p>
</div>
When clicking the “Save” button we are asked if we want to scale or add
a rest allele since the frequencies no longer sum to 1 now that a silent
allele frequency has been added. We click yes to scale.
<div class="figure">
<img src="scaling_ex2.png" alt="Figure 9: Scale frequencies or add rest allele." width="350"><p class="caption">
Figure 9: Scale frequencies or add rest allele.
</p>
</div>
<p><strong>Note 1</strong>: A rest allele can only be addded if the sum
of frequencies is less than 1. Therefore, enforced scaling will be
performed if we click “No” and the sum is larger than 1.</p>
<p><strong>Note 2</strong>: The added rest allele is given the name “r”.
If a stepwise mutation model is chosen (see section below), numeric
allele names are required, so in this case scaling must be chosen.</p>
</div>
</div>
<div class="section level3">
<h3 id="mutations-1">2. Mutations<a class="anchor" aria-label="anchor" href="#mutations-1"></a>
</h3>
<p>Clicking the mutation button in the main interface opens a new
window. By default mutations are not accounted for (mutation rate set to
0). There are three mutation models to choose from. The ‘Equal’ mutation
model assumes that all mutations are equally likely, the ‘Proportional’
model assumes mutation rates to be proportional to allele frequencies,
and the ‘Stepwise’ mutation model assumes that mutations to closer
allelles (fewer sequence repeats difference) are more probable. When
‘Stepwise’ is chosen, a range must also be specified that indicates the
relative probability of mutating n+1 steps versus mutating n steps. This
mutation model requires that the allele names are numerics indicating
the number of sequence repeats. It does not account for microinvariants,
and will treat mutations to and from microinvariants as practically
impossible. This option corresponds to the model ‘Stepwise
(unstationary)’ in Familias 3. Mutations to and from silent alleles are
not possible for any of the models. See the Familias manual for more
details on the mutation models (<a href="https://familias.no/" class="external-link uri">https://familias.no/</a>).</p>
In this example we will use an equal mutation model with mutation rate
0.1 for both males and females.
<div class="figure">
<img src="mutations_ex2.png" alt="Figure 10: Mutations in example 2." width="200"><p class="caption">
Figure 10: Mutations in example 2.
</p>
</div>
</div>
<div class="section level3">
<h3 id="pedigree-1">3. Pedigree<a class="anchor" aria-label="anchor" href="#pedigree-1"></a>
</h3>
<p>Since the hypotheses in this example are not covered by the built-in
pedigrees, we will provide RelMix with custom pedigrees defined in R
scripts. The R scripts can for instance be exported from Familias 3, but
can also be generated manually. The script below shows the code needed
to provide the first pedigree where the two contributors are mother and
child.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">persons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C2"</span>,<span class="st">"C1"</span><span class="op">)</span></span>
<span><span class="va">ped1</span> <span class="op">&lt;-</span> <span class="fu">FamiliasPedigree</span><span class="op">(</span>id<span class="op">=</span><span class="va">persons</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="cn">NA</span><span class="op">)</span>, </span>
<span>                         sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The second pedigree, where the two contributors are unrelated, is
defined as below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">persons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C2"</span>,<span class="st">"C1"</span><span class="op">)</span></span>
<span><span class="va">ped1</span> <span class="op">&lt;-</span> <span class="fu">FamiliasPedigree</span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">persons</span><span class="op">)</span>, dadid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, </span>
<span>                         momid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note 1</strong>: Each pedigree must be defined in a variable
called “ped1”.</p>
<p><strong>Note 2</strong>: The names of the individuals in a pedigree
(the id) must correspond to the names of individuals in the reference
profiles.</p>
<p><strong>Note 3</strong>: Each pedigree must be defined in a separate
R script.</p>
Figure 11 shows how to import the custom pedigrees from R scripts, one
script per pedigree.
<div class="figure">
<img src="custom_ped_ex2.png" alt="Figure 11: We import custom pedigrees from R scripts in example 2." width="300"><p class="caption">
Figure 11: We import custom pedigrees from R scripts in example 2.
</p>
</div>
</div>
<div class="section level3">
<h3 id="contributors-1">4. Contributors<a class="anchor" aria-label="anchor" href="#contributors-1"></a>
</h3>
Both individuals defined in the pedigrees are contributors under both
hypotheses. It is only their relationship that changes between the two
pedigrees.
<div class="figure">
<img src="contributors_ex2.png" alt="Figure 12: Tick both individuals as contributors to the mixture in both pedigrees." width="150"><p class="caption">
Figure 12: Tick both individuals as contributors to the mixture in both
pedigrees.
</p>
</div>
</div>
<div class="section level3">
<h3 id="dropout-and-drop-in-1">5. Dropout and drop-in<a class="anchor" aria-label="anchor" href="#dropout-and-drop-in-1"></a>
</h3>
<p>In this example we believe there may be dropout in both contributors’
profiles. We set their dropout probabilities to 0.1 and the drop-in
value to 0.05.</p>
<div class="figure">
<img src="dropout_ex2.png" alt="Figure 13: Possible dropout for both contributors in example 2." width="150"><p class="caption">
Figure 13: Possible dropout for both contributors in example 2.
</p>
</div>
</div>
<div class="section level3">
<h3 id="compute-lr-1">6. Compute LR<a class="anchor" aria-label="anchor" href="#compute-lr-1"></a>
</h3>
The resulting LR for example 2 is shown in Figure 14. Note that in
pedigree 2 there are are no relations to plot.
<div class="figure">
<img src="results_ex2.png" alt="Figure 14: Computed LR for example 2." width="500"><p class="caption">
Figure 14: Computed LR for example 2.
</p>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Dørum, G., Kaur, N., &amp; Gysi, M. (2017). Pedigree-based
relationship inference from complex DNA mixtures. International journal
of legal medicine, 131(3), 629-641.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Guro Dorum, Elias Hernandis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
